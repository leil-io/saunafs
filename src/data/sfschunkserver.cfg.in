# sfschunkserver.cfg(5)

## The label of this chunkserver (for tiering)
# LABEL = _

## User to run daemon as.
# WORKING_USER = @DEFAULT_USER@

## Group to run daemon as (if empty then default user group will be used).
# WORKING_GROUP = @DEFAULT_GROUP@

## Name of process to place in syslog messages (default is sfschunkserver)
# SYSLOG_IDENT = sfschunkserver

## Whether to perform mlockall() to avoid swapping out sfschunkserver.
## process, boolean (0 means "no").
## (Default: 0)
# LOCK_MEMORY = 0

## Linux only: limit glibc malloc arenas to given value - prevents from using
## huge amount of virtual memory. This can influence performance by reducing
## memory fragmentation and improving cache locality, but it may also lead to
## contention and reduced parallelism in multi-threaded applications.
## Use it in constrained memory environments, recommended values are 4 or 8.
## (default is 0: disabled or let glibc decide)
# LIMIT_GLIBC_MALLOC_ARENAS = 0

## Nice level to run daemon with (default is -19 if possible).
# NICE_LEVEL = -19

## Where to store data files and daemon lock file:
## (Default: @DATA_PATH@)
# DATA_PATH = @DATA_PATH@

## Delay in seconds before reconnection attempt to the master server after
## disconnection.
## (Default: 5)
# MASTER_RECONNECTION_DELAY = 5

## Local address to use for connecting with the master server.
# BIND_HOST = *

## SaunaFS master host to connect to.
## (Default: sfsmaster)
# MASTER_HOST = sfsmaster

## Master port to connect to (Default: 9420):
# MASTER_PORT = 9420

## Timeout (in seconds) for the master server connection (minimum is 0.01).
## (Default: 60)
# MASTER_TIMEOUT = 60

## Number of threads that the connection to master may use to process operations
## on chunks, like create, duplicate, replicate and truncate.
(Default: 10, Minimum: 2)
# MASTER_NR_OF_WORKERS = 10

## IP address to listen on for client (sfsmount) connections:
# CSSERV_LISTEN_HOST = *

## Port to listen for client (sfsmount) connections.
## (Default: 9422)
# CSSERV_LISTEN_PORT = 9422

## Name of volume configuration file.
## (Default: @ETC_PATH@/sfshdd.cfg)
# HDD_CONF_FILENAME = @ETC_PATH@/sfshdd.cfg

## Free space threshold to set volume as 100% utisaued when there is less than given amount of free
## space left. This number is always added to the used disk space reported by chunkserver.
## (Default: 4GiB)
# HDD_LEAVE_SPACE_DEFAULT = 4GiB

## Chunk test period in seconds.
## (Default: 10)
# HDD_TEST_FREQ = 10

## Whether to check the CRC on every read operation.
## This option enabled can detect CRC errors immediately when reading, at the
## cost of expensive CRC checking, even if the client will check it anyway.
## (Default: 1)
# HDD_CHECK_CRC_WHEN_READING = 1

## Whether to check the CRC on every write operation.
## This option enabled can detect CRC errors immediately when writing. The CRC
## calculation can become the function that consumes most of the CPU. The
## default, safest and recommended value is 1, but it can be disabled to test
## the influence of the CRC checking in the write performance during profiling.
## Disabling it is only intended for expert users and developers.
## (Default: 1)
# HDD_CHECK_CRC_WHEN_WRITING = 1

## Whether to remove each chunk from page when closing it to reduce cache pressure
## generated by chunkserver, boolean (0 means "no").
## (Default: 0)
# HDD_ADVISE_NO_CACHE = 0

## If enabled then chunkserver detects zero values in chunk data and frees
## corresponding file blocks (decreasing file system usage).
## This option works only on Linux
## with file systems supporting punching holes (SFS, ext4, Btrfs, tmpfs).
## (Default : 0)
# HDD_PUNCH_HOLES = 0

## If enabled, chunkserver will send periodical reports of its I/O load to master,
## which will be taken into consideration when picking chunkservers for I/O operations.
## (Default : 0)
# ENABLE_LOAD_FACTOR = 0

## Limit how many kilobytes can be replicated from other chunkservers to
## this chunkserver in every second (by default undefined, i.e. no limits)
# REPLICATION_BANDWIDTH_LIMIT_KBPS = 8192

## Number of threads which handle (in a round-robin manner) connections
## with clients; these threads are responsible for reading from
## sockets and coping data from internal buffers to sockets.
## (Default: 4)
# NR_OF_NETWORK_WORKERS = 4

## Number of threads that each network worker may use to do disk operations
## like opening chunks, reading or writing them
## (Default: 16)
# NR_OF_HDD_WORKERS_PER_NETWORK_WORKER = 16

## Maximum number of jobs that each network worker may use for disk operations.
## (Default: 1000)
# BGJOBSCNT_PER_NETWORK_WORKER = 1000

## Maximum amount of time in milliseconds that the polling operation will wait
## for events. In the chunkservers, the same value is applied for the events
## loop and for the network worker threads. Smaller values could reduce latency
## at the cost of CPU usage.
## (Default: 50)
# POLL_TIMEOUT_MS = 50

## additional number of kilobytes which should be passed to
## posix_fadvise(POSIX_FADV_WILLNEED) before reading data from a chunk
## (Default: 0), i.e. use posix_fadvise only with the amount of data that is
##  really needed; the value is aligned down to 64 KiB.
# READ_AHEAD_KB = 0

## Try to fix out-of-order read requests; the value tells how much of
## skipped data to read if an offset of some read operation is greater than
## the offset where the previous operation finished
## (Default: 0), i.e. don't read any skipped data; the value is aligned down to 64 KiB.
# MAX_READ_BEHIND_KB = 0

## Call fsync() after a chunk is modified
## (Default: 1), i.e. enabled.
#PERFORM_FSYNC = 1

## Verify that chunk metadata and data parts exists at scan time. If set to 1,
## the data part is also checked to be multiple of SFSBLOCKSIZE. Disabling this
## option accelerates the scan process, but does not check the chunk data files.
## Warning: use it with caution, only in scenarios where a fast chunkserver
## restart is needed.
## (Default: 1), i.e. enabled.
# STAT_CHUNKS_AT_DISK_SCAN = 1

## [ADVANCED] The DiskManager is responsible for assigning each chunk to a
## specific disk. By default the chunks are distributed in a balanced way among
## all the available disks. This variable can be changed to select a custom
## DiskManager implementation loaded from plugins.
## (Default: DEFAULT), the default balanced distribution will be used.
# DISK_MANAGER_TYPE = DEFAULT

## deprecated, to be removed.
# BACK_LOGS = 50
# CSSERV_TIMEOUT = 5

## Replication bandwidth limit
# REPLICATION_BANDWIDTH_LIMIT_KBPS = 102400

## Total timeout for single replication operation. Replications that take longer than that
## are considered failed and are immediately aborted.
# REPLICATION_TOTAL_TIMEOUT_MS = 60000

## Connection for single replication operation. If connecting to another chunkserver takes longer
## than this timeout, the operation is considered failed and is immediately aborted.
# REPLICATION_CONNECTION_TIMEOUT_MS = 1000

## [ADVANCED] Timeout for single wave in replication. After this timeout, next wave
## of read requests is sent to other chunkservers.
# REPLICATION_WAVE_TIMEOUT_MS = 500

## Enables or disables the chunk trash feature. When enabled, deleted chunks are
## moved to a trash directory instead of being immediately removed. (Default: 1)
# CHUNK_TRASH_ENABLED = 1

## Specifies the timeout in seconds for chunks to remain in the trash before
## being permanently deleted. (Default: 259200)
# CHUNK_TRASH_EXPIRATION_SECONDS = 259200

## Sets the available space threshold in gigabytes. If the available space on
## the disk falls below this threshold, the system will start deleting older
## chunks from the trash to free up space. (Default: 1024)
# CHUNK_TRASH_FREE_SPACE_THRESHOLD_GB = 1024

## Defines the bulk size for the garbage collector when processing chunks in the
## trash. This determines how many files are processed in each garbage
## collection cycle. (Default: 1000)
# CHUNK_TRASH_GC_BATCH_SIZE = 1000

## [ADVANCED] The number of files to remove from the trash in a single GC cycle,
## in case the disk is full ans space needs to be recovered. (Default: 100)
## (Default: 100)
# CHUNK_TRASH_GC_SPACE_RECOVERY_BATCH_SIZE = 100

## Setup logging. Uses the environment variable SAUNAFS_LOG_LEVEL or config
## value LOG_LEVEL to determine logging level.
## Valid log levels are
## 'trace'
## 'debug'
## 'info'
## 'warn' or 'warning'
## 'err' or 'error'
## 'crit' or 'critical'
## 'off'
# LOG_LEVEL = info
